/***************************************
* @preserve
* ForeSee Client Code: cxRecord Module
* http://www.answers.com/page/businesssolutions
* Built October 19, 16 14:25:42
* Code version: 19.0.35
* Template version: 19.0.35
***************************************/
("undefined"!=typeof _acsDefine?_acsDefine:define)(["require","_acs","triggerconfig","recordconfig",_acsNormalizeUrl("/trigger/fs.utils.js")],function(t,e,config,i,r){function s(){this.initialize.apply(this,arguments)}var n={_trackers:[]};n.Tracker=function(t,e,i,s,o,a){this.recorder=t,this.throttleTime=s,this.recFunction=o,this.subject=e,a||this._capture({},e),r.Bind(e,i,function(t,e){return function(i){t._capture&&t._capture(i,e),i=null,e=null}}(this,e)),n._trackers.push(this),e=null,t=null,i=null,o=null},n.Tracker.prototype.merge=function(t,e,i,s){r.Bind(e,i,function(t,e,i){return function(r){t._capture&&t._capture(r,e,i)}}(this,e,t)),t=null,i=null,s=null},n.Tracker.prototype._capture=function(t,e,i){clearTimeout(this.lastCapThrottle);var s=i||this.recorder;if(!this.lastCap||r.now()-this.lastCap>this.throttleTime)this.recFunction.call(this,t,e,s),this.lastCap=r.now();else{var n={};for(var o in t)6==o.length&&"layerX"!=o&&"layerY"!=o&&(n[o]=t[o]);this.lastCapThrottle=setTimeout(function(t,e,i,s){return r.isDefined(e.clientX)&&(e.sX=e.clientX,e.sY=e.clientY),function(){e.delayed=!0,t._capture&&t._capture(e,i,s)}}(this,n,e,s),this.throttleTime)}s=null,i=null,t=null,e=null},n.Tracker.prototype.dispose=function(){this.lastCapThrottle&&clearTimeout(this.lastCapThrottle),r.superDispose(this)};var o=n.Tracker,a={SESSIONID:"rpid",GLOBALSESSIONID:"mid",TRANSMITTING:"rt",CANCELED:"cncl",CANCELEDPERMANENT:"rcp",SESSION:"SESSION",DATA:"DATA",GLOBALREFRESHTIME:"grft"},h={_frames:[]};h.TrackFrame=function(t,e,i){var s=h._getFrameByXPath(t);s||h._frames.push({xp:t,nd:e,rc:i,sid:h._frames.length+"_",id:r.generateGUID(),initialized:!1})},h._getFrameByXPath=function(t){for(var e=t.join("/"),i=0;i<h._frames.length;i++)if(h._frames[i].xp.join("/")==e)return h._frames[i]},h._getFrameById=function(t){for(var e=0;e<h._frames.length;e++)if(h._frames[e].id==t)return h._frames[e]},h.BeginTrackingChildFrames=function(t){setInterval(function(){for(var e=0;e<h._frames.length;e++){var i=h._frames[e];!i.initialized&&i.nd.contentWindow&&i.nd.contentWindow.postMessage(JSON.stringify({cxr:!0,id:i.id,xp:i.xp,sid:i.sid,sp:A.getPosition(i.nd,t.win)}),"*")}},400),r.Bind(window,"message",function(e){if(e.data=e.data+"",e.data&&r.isFunction(e.data.indexOf)&&e.data.indexOf("_cxrXDS_")>-1){var i;try{i=JSON.parse(e.data)}catch(t){return}if(i){var s=h._getFrameById(i.id);if(s){var n=t.getLogger();s.initialized=!0,n._data&&n._data.length>0?n._data=n._data+","+i.data:n._data=i.data}}}});new o(t,t.win,"record:scroll",500,function(e,i,s){for(var n=(r.getScroll(t.win),0);n<h._frames.length;n++){var o=h._frames[n];o.initialized&&o.nd.contentWindow&&o.nd.contentWindow.postMessage(JSON.stringify({cxsp:!0,sp:A.getPosition(o.nd,t.win)}),"*")}})},h.SendDataToParentFrame=function(t,e,i){t.postMessage(JSON.stringify({_cxrXDS_:!0,id:e,data:i}),"*")};var c=function(t,e){this.browser=t,t.isIE&&t.browser.version<11&&"https:"!=location.protocol?(this._simple=!1,this.fstg=e):(this._simple=!0,this.ajax=new r.AjaxTransport)};c.prototype.send=function(t){if(this.ajax)this.ajax.send(t);else{var e=r.ext({method:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(){},failure:function(){}},t);this.fstg.ajax(e.method,e.url,e.data,function(t){return function(e,i){e?t.success(i):t.failure(i)}}(e),!0,e.contentType)}},c.prototype.dispose=function(){this.ajax&&this.ajax.dispose()};var l={BitStream:function(t,e){if(this.index="number"==typeof e?e:0,this.bitindex=0,this.buffer=t instanceof Uint8Array?t:new Uint8Array(l.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},byteArrayToString:function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},stringToByteArray:function(t){for(var e=[],i=0;i<t.length;i++)e[e.length]=t.charCodeAt(i);return e},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},fragmentAndCompress:function(t,e){e=e||1e5;for(var i="",r=parseInt(t.length/e)+1,s=0;s<r;s++){var n=t.substring(s*e,(s+1)*e),o=l._utf8_encode(n),a=l.stringToByteArray(o),h=new l.RawDeflate(a,{compressionType:2}).compress(),c=btoa(l.byteArrayToString(h));i+="_CMP_"+c}return i}};l.BitStream.DefaultBlockSize=32768,l.BitStream.prototype.expandBuffer=function(){var t=this.buffer,e=t.length,i=new Uint8Array(e<<1);return i.set(t),this.buffer=i},l.BitStream.prototype.writeBits=function(t,e,i){var r=this.buffer,s=this.index,n=this.bitindex,o=r[s];if(i&&1<e&&(t=8<e?(l.BitStream.ReverseTable[255&t]<<24|l.BitStream.ReverseTable[t>>>8&255]<<16|l.BitStream.ReverseTable[t>>>16&255]<<8|l.BitStream.ReverseTable[t>>>24&255])>>32-e:l.BitStream.ReverseTable[t]>>8-e),8>e+n)o=o<<e|t,n+=e;else for(i=0;i<e;++i)o=o<<1|t>>e-i-1&1,8===++n&&(n=0,r[s++]=l.BitStream.ReverseTable[o],o=0,s===r.length&&(r=this.expandBuffer()));r[s]=o,this.buffer=r,this.bitindex=n,this.index=s},l.BitStream.prototype.finish=function(){var t=this.buffer,e=this.index;return 0<this.bitindex&&(t[e]<<=8-this.bitindex,t[e]=l.BitStream.ReverseTable[t[e]],e++),t=t.subarray(0,e)},l.BitStream.ReverseTable=function(t){return t}(function(){if("undefined"!=typeof Uint8Array){var t,e=new Uint8Array(256);for(t=0;256>t;++t){for(var i=e,r=t,s=t,n=s,o=7,s=s>>>1;s;s>>>=1)n<<=1,n|=1&s,--o;i[r]=(n<<o&255)>>>0}return e}}()),l.Heap=function(t){this.buffer=new Uint16Array(2*t),this.length=0},l.Heap.prototype.getParent=function(t){return 2*((t-2)/4|0)},l.Heap.prototype.getChild=function(t){return 2*t+2},l.Heap.prototype.push=function(t,e){var i,r,s,n=this.buffer;for(i=this.length,n[this.length++]=e,n[this.length++]=t;0<i&&(r=this.getParent(i),n[i]>n[r]);)s=n[i],n[i]=n[r],n[r]=s,s=n[i+1],n[i+1]=n[r+1],n[r+1]=s,i=r;return this.length},l.Heap.prototype.pop=function(){var t,e,i,r,s,n=this.buffer;for(e=n[0],t=n[1],this.length-=2,n[0]=n[this.length],n[1]=n[this.length+1],s=0;(r=this.getChild(s),!(r>=this.length))&&(r+2<this.length&&n[r+2]>n[r]&&(r+=2),n[r]>n[s]);)i=n[s],n[s]=n[r],n[r]=i,i=n[s+1],n[s+1]=n[r+1],n[r+1]=i,s=r;return{index:t,value:e,length:this.length}},l.RawDeflate=function(t,e){this.compressionType=l.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.input=t instanceof Array?new Uint8Array(t):t,this.op=0,e&&(e.lazy&&(this.lazy=e.lazy),"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e.outputBuffer&&(this.output=e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.op=e.outputIndex)),this.output||(this.output=new Uint8Array(32768))},l.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},l.RawDeflate.Lz77MinLength=3,l.RawDeflate.Lz77MaxLength=258,l.RawDeflate.WindowSize=32768,l.RawDeflate.MaxCodeLength=16,l.RawDeflate.HUFMAX=286,l.RawDeflate.FixedHuffmanTable=function(){var t,e=[];for(t=0;288>t;t++)switch(!0){case 143>=t:e.push([t+48,8]);break;case 255>=t:e.push([t-144+400,9]);break;case 279>=t:e.push([t-256,7]);break;case 287>=t:e.push([t-280+192,8]);break;default:throw"invalid literal: "+t}return e}(),l.RawDeflate.prototype.compress=function(){var t,e,i,r=this.input;switch(this.compressionType){case l.RawDeflate.CompressionType.NONE:for(e=0,i=r.length;e<i;)t=r.subarray(e,e+65535),e+=t.length,this.makeNocompressBlock(t,e===i);break;case l.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(r,!0),this.op=this.output.length;break;case l.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(r,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},l.RawDeflate.prototype.makeNocompressBlock=function(t,e){var i,r,s=this.output,n=this.op;for(s=new Uint8Array(this.output.buffer);s.length<=n+t.length+5;)s=new Uint8Array(s.length<<1);return s.set(this.output),i=l.RawDeflate.CompressionType.NONE,s[n++]=(e?1:0)|i<<1,i=t.length,r=~i+65536&65535,s[n++]=255&i,s[n++]=i>>>8&255,s[n++]=255&r,s[n++]=r>>>8&255,s.set(t,n),n+=t.length,s=s.subarray(0,n),this.op=n,this.output=s},l.RawDeflate.prototype.makeFixedHuffmanBlock=function(t,e){var i,r=new l.BitStream(new Uint8Array(this.output.buffer),this.op);return i=l.RawDeflate.CompressionType.FIXED,r.writeBits(e?1:0,1,!0),r.writeBits(i,2,!0),i=this.lz77(t),this.fixedHuffman(i,r),r.finish()},l.RawDeflate.prototype.makeDynamicHuffmanBlock=function(t,e){var i,r,s,n,o,a,h,c,d,u,f,p=new l.BitStream(new Uint8Array(this.output.buffer),this.op),g=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],m=Array(19);for(i=l.RawDeflate.CompressionType.DYNAMIC,p.writeBits(e?1:0,1,!0),p.writeBits(i,2,!0),i=this.lz77(t),o=this.getLengths_(this.freqsLitLen,15),a=this.getCodesFromLengths_(o),h=this.getLengths_(this.freqsDist,7),c=this.getCodesFromLengths_(h),r=286;257<r&&0===o[r-1];r--);for(s=30;1<s&&0===h[s-1];s--);for(d=this.getTreeSymbols_(r,o,s,h),u=this.getLengths_(d.freqs,7),f=0;19>f;f++)m[f]=u[g[f]];for(n=19;4<n&&0===m[n-1];n--);for(g=this.getCodesFromLengths_(u),p.writeBits(r-257,5,!0),p.writeBits(s-1,5,!0),p.writeBits(n-4,4,!0),f=0;f<n;f++)p.writeBits(m[f],3,!0);for(f=0,m=d.codes.length;f<m;f++)if(r=d.codes[f],p.writeBits(g[r],u[r],!0),16<=r){switch(f++,r){case 16:r=2;break;case 17:r=3;break;case 18:r=7;break;default:throw"invalid code: "+r}p.writeBits(d.codes[f],r,!0)}return this.dynamicHuffman(i,[a,o],[c,h],p),p.finish()},l.RawDeflate.prototype.dynamicHuffman=function(t,e,i,r){var s,n,o,a,h;for(o=e[0],e=e[1],a=i[0],h=i[1],i=0,s=t.length;i<s;++i)if(n=t[i],r.writeBits(o[n],e[n],!0),256<n)r.writeBits(t[++i],t[++i],!0),n=t[++i],r.writeBits(a[n],h[n],!0),r.writeBits(t[++i],t[++i],!0);else if(256===n)break;return r},l.RawDeflate.prototype.fixedHuffman=function(t,e){var i,r,s;for(i=0,r=t.length;i<r;i++)if(s=t[i],l.BitStream.prototype.writeBits.apply(e,l.RawDeflate.FixedHuffmanTable[s]),256<s)e.writeBits(t[++i],t[++i],!0),e.writeBits(t[++i],5),e.writeBits(t[++i],t[++i],!0);else if(256===s)break;return e},l.RawDeflate.Lz77Match=function(t,e){this.length=t,this.backwardDistance=e},l.RawDeflate.Lz77Match.LengthCodeTable=function(t){if("undefined"!=typeof Uint32Array)return new Uint32Array(t)}(function(){function t(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:throw"invalid length: "+t}}var e,i,r=[];for(e=3;258>=e;e++)i=t(e),r[e]=i[2]<<24|i[1]<<16|i[0];return r}()),l.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(t){switch(!0){case 1===t:t=[0,t-1,0];break;case 2===t:t=[1,t-2,0];break;case 3===t:t=[2,t-3,0];break;case 4===t:t=[3,t-4,0];break;case 6>=t:t=[4,t-5,1];break;case 8>=t:t=[5,t-7,1];break;case 12>=t:t=[6,t-9,2];break;case 16>=t:t=[7,t-13,2];break;case 24>=t:t=[8,t-17,3];break;case 32>=t:t=[9,t-25,3];break;case 48>=t:t=[10,t-33,4];break;case 64>=t:t=[11,t-49,4];break;case 96>=t:t=[12,t-65,5];break;case 128>=t:t=[13,t-97,5];break;case 192>=t:t=[14,t-129,6];break;case 256>=t:t=[15,t-193,6];break;case 384>=t:t=[16,t-257,7];break;case 512>=t:t=[17,t-385,7];break;case 768>=t:t=[18,t-513,8];break;case 1024>=t:t=[19,t-769,8];break;case 1536>=t:t=[20,t-1025,9];break;case 2048>=t:t=[21,t-1537,9];break;case 3072>=t:t=[22,t-2049,10];break;case 4096>=t:t=[23,t-3073,10];break;case 6144>=t:t=[24,t-4097,11];break;case 8192>=t:t=[25,t-6145,11];break;case 12288>=t:t=[26,t-8193,12];break;case 16384>=t:t=[27,t-12289,12];break;case 24576>=t:t=[28,t-16385,13];break;case 32768>=t:t=[29,t-24577,13];break;default:throw"invalid distance"}return t},l.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var t,e=this.backwardDistance,i=[],r=0;return t=l.RawDeflate.Lz77Match.LengthCodeTable[this.length],i[r++]=65535&t,i[r++]=t>>16&255,i[r++]=t>>24,t=this.getDistanceCode_(e),i[r++]=t[0],i[r++]=t[1],i[r++]=t[2],i},l.RawDeflate.prototype.lz77=function(t){function e(t,e){var i,r,s=t.toLz77Array();for(i=0,r=s.length;i<r;++i)d[u++]=s[i];p[s[0]]++,g[s[3]]++,f=t.length+e-1,a=null}var i,r,s,n,o,a,h={},c=l.RawDeflate.WindowSize,d=new Uint16Array(2*t.length),u=0,f=0,p=new Uint32Array(286),g=new Uint32Array(30),m=this.lazy;for(s=0;285>=s;)p[s++]=0;for(s=0;29>=s;)g[s++]=0;for(p[256]=1,i=0,r=t.length;i<r;++i){for(s=o=0,n=l.RawDeflate.Lz77MinLength;s<n&&i+s!==r;++s)o=o<<8|t[i+s];if(void 0===h[o]&&(h[o]=[]),s=h[o],!(0<f--)){for(;0<s.length&&i-s[0]>c;)s.shift();if(i+l.RawDeflate.Lz77MinLength>=r){for(a&&e(a,-1),s=0,n=r-i;s<n;++s)o=t[i+s],d[u++]=o,++p[o];break}0<s.length?(n=this.searchLongestMatch_(t,i,s),a?a.length<n.length?(o=t[i-1],d[u++]=o,++p[o],e(n,0)):e(a,-1):n.length<m?a=n:e(n,0)):a?e(a,-1):(o=t[i],d[u++]=o,++p[o])}s.push(i)}return d[u++]=256,p[256]++,this.freqsLitLen=p,this.freqsDist=g,d.subarray(0,u)},l.RawDeflate.prototype.searchLongestMatch_=function(t,e,i){var r,s,n,o,a,h=0,c=t.length;o=0,a=i.length;t:for(;o<a;o++){if(r=i[a-o-1],n=l.RawDeflate.Lz77MinLength,h>l.RawDeflate.Lz77MinLength){for(n=h;n>l.RawDeflate.Lz77MinLength;n--)if(t[r+n-1]!==t[e+n-1])continue t;n=h}for(;n<l.RawDeflate.Lz77MaxLength&&e+n<c&&t[r+n]===t[e+n];)++n;if(n>h&&(s=r,h=n),n===l.RawDeflate.Lz77MaxLength)break}return new l.RawDeflate.Lz77Match(h,e-s)},l.RawDeflate.prototype.getTreeSymbols_=function(t,e,i,r){var s,n,o=new Uint32Array(t+i),a=new Uint32Array(316),h=new Uint8Array(19);for(s=n=0;s<t;s++)o[n++]=e[s];for(s=0;s<i;s++)o[n++]=r[s];for(s=0,e=h.length;s<e;++s)h[s]=0;for(s=i=0,e=o.length;s<e;s+=n){for(n=1;s+n<e&&o[s+n]===o[s];++n);if(t=n,0===o[s])if(3>t)for(;0<t--;)a[i++]=0,h[0]++;else for(;0<t;)r=138>t?t:138,r>t-3&&r<t&&(r=t-3),10>=r?(a[i++]=17,a[i++]=r-3,h[17]++):(a[i++]=18,a[i++]=r-11,h[18]++),t-=r;else if(a[i++]=o[s],h[o[s]]++,t--,3>t)for(;0<t--;)a[i++]=o[s],h[o[s]]++;else for(;0<t;)r=6>t?t:6,r>t-3&&r<t&&(r=t-3),a[i++]=16,a[i++]=r-3,h[16]++,t-=r}return{codes:a.subarray(0,i),freqs:h}},l.RawDeflate.prototype.getLengths_=function(t,e){var i,r,s,n=t.length,o=new l.Heap(2*l.RawDeflate.HUFMAX),a=new Uint8Array(n);for(r=0;r<n;r++)a[r]=0;for(r=0;r<n;++r)0<t[r]&&o.push(r,t[r]);if(n=Array(o.length/2),i=new Uint32Array(o.length/2),1===n.length)return a[o.pop().index]=1,a;for(r=0,s=o.length/2;r<s;++r)n[r]=o.pop(),i[r]=n[r].value;for(o=this.reversePackageMerge_(i,i.length,e),r=0,s=n.length;r<s;++r)a[n[r].index]=o[r];return a},l.RawDeflate.prototype.reversePackageMerge_=function(t,e,i){function r(t){var i=l[t][d[t]];i===e?(r(t+1),r(t+1)):--h[i],++d[t]}var s,n,o=new Uint16Array(i),a=new Uint8Array(i),h=new Uint8Array(e),c=Array(i),l=Array(i),d=Array(i),u=(1<<i)-e,f=1<<i-1;for(o[i-1]=e,s=0;s<i;++s)u<f?a[s]=0:(a[s]=1,u-=f),u<<=1,o[i-2-s]=(o[i-1-s]/2|0)+e;for(o[0]=a[0],c[0]=Array(o[0]),l[0]=Array(o[0]),s=1;s<i;++s)o[s]>2*o[s-1]+a[s]&&(o[s]=2*o[s-1]+a[s]),c[s]=Array(o[s]),l[s]=Array(o[s]);for(u=0;u<e;++u)h[u]=i;for(f=0;f<o[i-1];++f)c[i-1][f]=t[f],l[i-1][f]=f;for(u=0;u<i;++u)d[u]=0;for(1===a[i-1]&&(--h[0],++d[i-1]),s=i-2;0<=s;--s){for(i=u=0,n=d[s+1],f=0;f<o[s];f++)i=c[s+1][n]+c[s+1][n+1],i>t[u]?(c[s][f]=i,l[s][f]=e,n+=2):(c[s][f]=t[u],l[s][f]=u,++u);d[s]=0,1===a[s]&&r(s)}return h},l.RawDeflate.prototype.getCodesFromLengths_=function(t){var e,i,r,s=new Uint16Array(t.length),n=[],o=[],a=0;for(e=0,i=t.length;e<i;e++)n[t[e]]=(0|n[t[e]])+1;for(e=1,i=l.RawDeflate.MaxCodeLength;e<=i;e++)o[e]=a,a+=0|n[e],a<<=1;for(e=0,i=t.length;e<i;e++)for(a=o[t[e]],o[t[e]]+=1,n=s[e]=0,r=t[e];n<r;n++)s[e]=s[e]<<1|1&a,a>>>=1;return s},l.CompressionMethod={DEFLATE:8,RESERVED:15};var d=function(t,e){for(var i=t,r=e,s=t.length,n=e.length,o=s>n?n:s,a=o,h=0,c=0,l=0,d=0;a-h>15;)d=Math.round((a-h)/2),l=a-d,i.substr(0,l)!=r.substr(0,l)?a=l:h=l;var u=e.substr(h);for(a=u.length;a-c>15;)d=Math.round((a-c)/2),l=a-d,u.substr(u.length-l)!=i.substr(i.length-l)?a=l:c=l;return{o:h,c:c,r:e.substring(h,e.length-c)}},u=[],f=function(t,i,s,config){this.config=config,this.recorder=s,this.browser=i,this.cors=new c(i,t.fstg),this.isIframeMode=s.isIframeMode;var n=t.get([a.GLOBALSESSIONID,a.TRANSMITTING,a.CANCELED,"pv"]),o=n[a.GLOBALSESSIONID],h=n[a.TRANSMITTING],l=n[a.CANCELED],d=r.getScreenResolution();this.stg=t,this.pageViews=t.get("pv"),this.failCount=0,this.transportid=0,this.lastTransmissionTime=0,this.holdTransmits=!1,this.transmitting=!1,this.canceled=!1,this.siteid=config.clientId||"unk",this.domain=document.domain.toString(),this.StorageReady=new r.FSEvent,this.TransportReady=new r.FSEvent,this._quickXpathCache={},this._reset(),this.isIframeMode?(this.TransportReady.fire(),this.transmitting=!0,this.StorageReady.fire(),this.iFrameCommitItv=setInterval(r.proxy(this._flushAndTransmit,this),1e3)):(this.log(s,f.EVENT_TYPES.PAGE_MARKER,{dtm:e.startTS,ofs:(new Date).getTimezoneOffset(),v:i.browser.name,dv:i.browser.version,sid:config.clientId,r:"W3C",l:config.layout,m:i.isMobile,f:document.referrer.toString(),sz:{w:d.w,h:d.h}},-1),r.Bind(window,"unload",r.proxy(function(){this.commitData()},this)),this._backup_storage=new r.DomStorage(this.siteid,(!1),(!1),i),this._storage=new r.WindowStorage(this.siteid,(!1),i),this._syncStorage(),this._syncSession(o,!!h,!!l),this._syncData(),this.startStateMonitor(),this.startStorageMonitor(),this.TransportReady.subscribe(r.proxy(function(){this.StorageReady.fire(),this.transmitting&&this.startHeartbeat(),this._flushAndTransmit()},this),!0,!0),this.TransportReady.fire(),this.recorder.ready.subscribe(r.proxy(function(){this.recorder.EmergencySendRequired.subscribe(r.proxy(function(){this._flushAndTransmit(!0)},this))},this),!0,!0)),s=null};f.prototype.commitData=function(){this._flush(),this.transmitting&&this._transmit(),this._storage&&(this._storage.set(a.SESSION,this._session),this._storage.setBlob(this._data),this._storage.commit()),this._backup_storage&&(this._backup_storage.set(a.SESSION,this._session),this._backup_storage.setBlob(this._data),this._backup_storage.commit())},f.prototype.dispose=function(){this._flush(),this.cors.dispose(),this.iFrameCommitItv&&clearInterval(this.iFrameCommitItv),this.recorder.EmergencySendRequired.unsubscribeAll(),this.recorder.EmergencySendRequired=null,this.stopStorageMonitor(),this.stopStateMonitor()},f.prototype.setTransmitOK=function(){this.canceled||(this.transmitting=!0,this._session[a.TRANSMITTING]=!0,this.stg.set(a.TRANSMITTING,!0),this._flushAndTransmit(),this.startHeartbeat())},f.prototype.setTransmitNotOK=function(){this.stopHeartbeat(),this.transmitting=!1,this._session[a.TRANSMITTING]=!1,this.stg.set(a.TRANSMITTING,!1)},f.prototype.cancelRecord=function(t){this.setTransmitNotOK(),this.stopStateMonitor(),this.stopStorageMonitor(),this.canceled=!0,this._session[a.CANCELED]=!0,this.stg.set(a.CANCELED,!0),t&&this.stg.set(_SESSION_SYMBOLS.CANCELEDPERMANENT,this.cancel),this.iFrameCommitItv&&clearInterval(this.iFrameCommitItv),this._reset()},f.prototype._syncStorage=function(){var t,e,i=this._storage,r=this._backup_storage;i&&r&&i.isNew()&&!r.isNew()&&(t=r.get(a.SESSION),i.set(a.SESSION,t),e=r.getBlob(),i.setBlob(e))},f.prototype._syncSession=function(t,e,i){var s=this._storage||this._backup_storage;if(s)if(s.get(a.SESSION)){if(this._session=s.get(a.SESSION),this.sessionid=this._session[a.SESSIONID],this.gsessionid=this._session[a.GLOBALSESSIONID],this.refreshLastTime=this._session[a.GLOBALREFRESHTIME],this.refreshLastTime){this.refreshLastTime=parseInt(this.refreshLastTime);var n=36e5;r.now()-this.refreshLastTime>n&&(this.gsessionid=r.generateGUID(),this.sessionid=r.generateGUID(),this._session[a.GLOBALSESSIONID]=this.gsessionid,this._session[a.SESSIONID]=this.sessionid)}this.refreshLastTime=r.now(),this._session[a.GLOBALREFRESHTIME]=this.refreshLastTime,this.stg.set(a.GLOBALREFRESHTIME,this.refreshLastTime),this.stg.set(a.GLOBALSESSIONID,this.gsessionid),this.stg.set(a.SESSIONID,this.sessionid),r.isDefined(e)?(this.transmitting=e,this._session[a.TRANSMITTING]=this.transmitting):(this.transmitting=this._session[a.TRANSMITTING],this.stg.set(a.TRANSMITTING,this.transmitting)),r.isDefined(i)?(this.canceled=i,this._session[a.CANCELED]=this.canceled):(this.canceled=this._session[a.CANCELED],this.stg.set(a.CANCELED,this.canceled)),s.set(a.SESSION,this._session)}else this._session={},this.sessionid=r.generateGUID(),this._session[a.SESSIONID]=this.sessionid,t||(t=r.generateGUID()),this.gsessionid=t,this._session[a.GLOBALSESSIONID]=this.gsessionid,this._session[a.GLOBALREFRESHTIME]=r.now(),this.stg.set(a.GLOBALREFRESHTIME,this._session[a.GLOBALREFRESHTIME]),this.stg.set(a.GLOBALSESSIONID,this.gsessionid),this.transmitting=e,this._session[a.TRANSMITTING]=this.transmitting,this.stg.set(a.TRANSMITTING,this.transmitting),this.canceled=i,this._session[a.CANCELED]=this.canceled,this.stg.set(a.CANCELED,this.canceled),s.set(a.SESSION,this._session),s.commit()},f.prototype._syncData=function(){this._storage?this._data=this._storage.getBlob():this._backup_storage&&(this._data=this._backup_storage.getBlob())},f.prototype._flushAndTransmit=function(t){if((this._storage||this._backup_storage)&&!this.canceled||this.isIframeMode){var e=this.testStorageLimit();this.transmitting&&(r.now()-this.lastTransmissionTime>5e3||t)||e||this.isIframeMode?(this._flush(),this._transmit()):t&&this.browser.isMobile&&this.commitData()}},f.prototype.processImmediately=function(t){this.cors.send({method:"GET",url:r.sign(i.rec_transport_url+"process/"+encodeURIComponent(this.gsessionid)+"?delay="+(t||0)),failure:r.proxy(function(t){},this),success:r.proxy(function(t){},this)})},f.prototype._transmit=function(){if(0!==this._data.length||this.isIframeMode){if(this.isIframeMode)return void(this._data.length>0&&(h.SendDataToParentFrame(this.recorder.iFrameParentFr,this.recorder.ifrid,this._data),this._data=""));if(this.holdTransmits&&r.now()-this.lastTransmissionTime<1e4)return void(this.hasEmergency=!0);this.holdTransmits=!0,this.hasEmergency=!1,this.lastTransmissionTime=r.now();var t,e="corsservice",s=this.siteid.replace(/[- _.&]/g,"").toLowerCase(),n='{"data":['+this._data+"]}";p.set("rtp",e.substr(0,1)),n.length>1e3&&(n=l.fragmentAndCompress(n)),t="datalen:"+n.length+",time:"+r.now(),p.increment("rta"),this.cors.send({action:"data",method:"POST",contentType:"text/plain;charset=UTF-8",encoding:encodeURIComponent(A.getEncoding()),version:5,gSessionId:this.gsessionid,sessionId:this.sessionid,domain:this.domain||window.location.hostname,siteId:s,url:i.rec_transport_url+e+"?action=data&metadata="+encodeURIComponent(t)+"&encoding="+encodeURIComponent(A.getEncoding())+"&session_id="+encodeURIComponent(this.sessionid)+"&global_session_id="+encodeURIComponent(this.gsessionid)+"&domain="+encodeURIComponent(this.domain)+"&site_id="+encodeURIComponent(s)+"&version=5.0&cachebust="+Math.random(),skipEncode:!0,data:n,failure:r.proxy(function(t){p.increment("rtf"),this.failCount++,this.holdTransmits=!1;try{t=JSON.parse(t)}catch(t){}if(r.isDefined(t.status)){var e=Math.abs(parseInt(t.status));p.increment("rtf"+e)}return this.failCount>10?(p.set("rtcr",1),p.set("rtcp",this.pageViews),void this.cancelRecord()):void(this.hasEmergency&&setTimeout(r.proxy(function(){this._flushAndTransmit(!0)},this),100))},this),success:function(t,e,i){return function(s){p.increment("rts"),t.failCount=0,t.holdTransmits=!1;try{s=JSON.parse(s)}catch(t){}if(r.isDefined(s.status)){var n=parseInt(s.status,10);if(1==n)e==t.transportid?t._data="":t._data.substr(0,i.length)==i&&(t._data=t._data.substr(i.length));else if(2==n)return p.set("rtcr",2),p.set("rtcp",t.pageViews),void t.cancelRecord();t.hasEmergency&&setTimeout(function(){t._flushAndTransmit(!0)},100)}}}(this,this.transportid,this._data+"")})}},f.prototype._ping=function(){if(r.isDefined(this.transport)&&!this.canceled){var t=this.siteid.replace(/[- _.&]/g,"").toLowerCase();this.transport||(this.transport=new this.transport);var e=this.transport instanceof r.AjaxTransport?"corsservice":"amfservice/amf";this.cors.send({action:"ping",contentType:"text/plain;charset=UTF-8",sessionId:this.sessionid,siteId:t,url:i.rec_transport_url+e+"?action=ping&session_id="+encodeURIComponent(this.sessionid)+"&site_id="+encodeURIComponent(t)+"&cachebust="+Math.random(),skipEncode:!0,data:"",failure:function(){},success:function(){}})}},f.prototype._reset=function(){this._log={start:this._log?r.now():e.startTS,log:[],guid:r.generateGUID()},this._log_size_est=0},f.prototype._flush=function(){if(0!==this._log.log.length){this.transportid++,this._log.log.toJSON=null;var t=JSON.stringify(this._log);t&&t.length>0&&(this._data&&this._data.length>0?this._data=this._data+","+t:this._data=t),this._reset()}},f.prototype.logXPath=function(t,e){if(!this.canceled){if(e=e.join(","),!r.isDefined(this._quickXpathCache[e])){u[u.length]=e;var i=this.recorder.iFramexPathPrefix+(u.length-1);this._quickXpathCache[e]=i,this.log(t,f.EVENT_TYPES.XPATH_CACHE,{idx:i,xp:e},i)}return this._quickXpathCache[e]}},f.prototype.log=function(t,e,i,s,n){if(!this.canceled){var o=0;n||(n=0);var a={x:r.isDefined(s)?s:this.logXPath(t,t.getPath()),e:e,d:i,t:Math.max(0,r.now()-this._log.start-n)};this._log.log[this._log.log.length]=a,e==f.EVENT_TYPES.DOM_SERIALIZE?i.dom.str&&(o=i.dom.str.length,this._log_size_est+=o):e==f.EVENT_TYPES.CSS_SERIALIZE?i.stylesheet?(o=i.stylesheet.length,this._log_size_est+=o):i.v&&(o=Math.round(1*i.v.length),this._log_size_est+=o):e==f.EVENT_TYPES.DOM_MUTATION_NODE_MODIFIED?i.h.str||i.h.diff?(o=Math.round(1*((i.h.str?i.h.str.length:0)+(i.h.diff?i.h.diff.d.r.length:0)+(i.h.kl?i.h.kl.length:0)+(i.h.uid?i.h.uid.length:0))),o+=50,this._log_size_est+=o):(o=84,this._log_size_est+=o):(o=60,this._log_size_est+=o)}},f.prototype.testStorageLimit=function(){return!this.isIframeMode&&this._data.length+this._log_size_est>3e6},f.prototype._monitorState=function(){var t=this.stg.get([a.CANCELED,a.TRANSMITTING]),e=t[a.CANCELED],i=t[a.TRANSMITTING];return r.isDefined(e)&&this.canceled!=e&&e?void this.cancelRecord():void(r.isDefined(i)&&this.transmitting!=i&&(i?this.setTransmitOK():this.setTransmitNotOK()))},f.prototype.startHeartbeat=function(){this.heartbeatTransmit||(this._ping(),this.heartbeatTransmit=setInterval(r.proxy(function(){this._ping()},this),45e3))},f.prototype.stopHeartbeat=function(){this.heartbeatTransmit&&(clearInterval(this.heartbeatTransmit),delete this.heartbeatTransmit)},f.prototype.startStateMonitor=function(){this.stateMonitor||(this._monitorState(),this.stateMonitor=setInterval(r.proxy(function(){this._monitorState()},this),2e3))},f.prototype.stopStateMonitor=function(){this.stateMonitor&&(clearInterval(this.stateMonitor),delete this.stateMonitor)},f.prototype.startStorageMonitor=function(){this.storageMonitor||(this.storageMonitor=setInterval(r.proxy(function(){this.log(this.recorder,f.EVENT_TYPES.HEARTBEAT,{ofs:(new Date).getTimezoneOffset()},-1),this._flushAndTransmit()},this),this.browser.isMobile?1e4:2e4))},f.prototype.stopStorageMonitor=function(){this.storageMonitor&&(clearInterval(this.storageMonitor),delete this.storageMonitor)},f.EVENT_TYPES={DOM_SERIALIZE:0,XPATH_CACHE:1,FRAME_SIZE:2,FRAME_SCROLL:3,MOUSE_MOVE:4,WINDOW_MOUSEOUT_MOUSEENTER:5,INPUT_SERIALIZE:6,FOCUS_BLUR:7,KEY_PRESS:8,CARET_INFO:9,VALUE_CHANGED:10,DOM_MUTATION_NODE_MODIFIED:11,DOM_MUTATION_NODE_ATTR_MODIFIED:12,JAVASCRIPT_ERROR:13,MOUSE_CLICK:14,MOUSE_DOWN:15,MOUSE_UP:16,PAGE_MARKER:17,DOC_SIZE:18,SCROLL_EL:19,NOT_RECORDED:20,CSS_SERIALIZE:21,ORIENTATION:22,ZOOM:23,TOUCH:24,INCOMPLETE_INPUT_CAPTURE:25,ORIENTATION_CHANGE:26,CUSTOM_BEHAVIOR:27,CUSTOM_ERROR:28,HEARTBEAT:29};var p={};p.increment=function(t,e){try{var i=t.get("meta")||{};i[e]=(i[e]||0)+1,t.set("meta",i)}catch(t){}},p.set=function(t,e,i){try{var r=t.get("meta")||{};r[e]=i,t.set("meta",r)}catch(t){}};var g=function(t,e,config,i){this.config=config,this.browser=e,this.isXDRIFrameMode=i,this.isTop=t.getTop()==t,this.recorder=t,this.mutation=new C(t),this._setupMouseTracking(),this.sizeCapture=new o(this.recorder,this.recorder.win,"resize",700,function(t,i,s){var n=r.getSize(s.win),o=0,a=s.getLogger(),h=A.getDocSize(s.doc),c={w:h.width,h:h.height};if(s.docSize=h,e.isMobile){var l=n;n=c,c=l,o=window.orientation}a.log(s,f.EVENT_TYPES.FRAME_SIZE,{sz:n,avs:c,st:o,m:e.isMobile},null,-350),a.log(s,f.EVENT_TYPES.DOC_SIZE,{sz:{w:h.width,h:h.height}},null,-340)});var s=this.recorder.win.onerror;this.recorder.win.onerror=r.proxy(function(t,e,i){this.getLogger().log(this,f.EVENT_TYPES.JAVASCRIPT_ERROR,{v:t+", "+e+", "+i}),s&&s.apply(this.win,arguments)},this.recorder),this.inputCaptures=[],this.updateNodeBinding(this.recorder.win.document.body,!1,!0),this.inputReserialize=function(t,e,i){return function(){setTimeout(function(){try{t.recorder.win.document}catch(t){return}for(var e=0;e<i.length;e++){var s=i[e];i[e].hasChanged()&&r.isDefined(s.input)&&"SELECT"!=s.input.nodeName&&(s.lastValue=s.input.value,s.serialize())}},20),t.isTop||t.recorder.getTop().eventcap.inputReserialize.apply()}}(this,this.recorder,this.inputCaptures),r.Bind(this.recorder.win.document,"record:click",this.inputReserialize),r.Bind(this.recorder.win.document,"record:touchstart",this.inputReserialize),this.config.advancedSettings&&this.config.advancedSettings.scrollEls&&(this._setupScrollTracking(),t.DomUpdated.subscribe(r.proxy(function(t){this._setupScrollTracking(t)},this))),t=null};g.prototype._setupScrollTracking=function(t){t||(t=document);var e=this.config.advancedSettings.scrollEls;if(r.isString(e))for(var i=t.querySelectorAll(e),s=function(t){return function(e,i){i||(i=e.target||e.srcElement),i&&t.getLogger().log(t,f.EVENT_TYPES.SCROLL_EL,{x:t.getLogger().logXPath(t,k.getMapping(i)),ps:{x:i.scrollLeft,y:i.scrollTop}})}},n=0;n<i.length;n++)i[n]._fsrScrollCapture||(i[n]._fsrScrollCapture=new o(this.recorder,i[n],"scroll",400,s(this.recorder)))},g.prototype._setupMouseTracking=function(){var t=this,e=function(e,i,s,n){var o=f.EVENT_TYPES,a=s.getLogger();if(e.delayed||s.getTop().isMousedOverWindow||(a.log(s,o.WINDOW_MOUSEOUT_MOUSEENTER,{st:1}),s.getTop().isMousedOverWindow=!0),s.getTop().isMousedOverWindow){n=n||o.MOUSE_MOVE;var h={x:"unknown"!=typeof e.clientX?e.clientX:"unknown"!=typeof e.screenX?e.screenX:e.sX,y:"unknown"!=typeof e.clientY?e.clientY:"unknown"!=typeof e.screenY?e.screenY:e.sY},c=-1;if(n==o.MOUSE_CLICK||n==o.MOUSE_DOWN){var l=e.explicitOriginalTarget||e.originalTarget||e.target||e.srcElement;l&&(c=a.logXPath(s,k.getMapping(l)))}var d=r.getScroll(s.win);if("undefined"==typeof h.x&&(h=s.lastRawMouseCoords),r.isDefined(h)){s.lastRawMouseCoords=h;var u={x:d.x+h.x,y:d.y+h.y};if(s.win!==s.win.top)if(t.isXDRIFrameMode)u.x+=s.ifrFrameOffset.x-d.x,u.y+=s.ifrFrameOffset.y-d.y;else{var p=s.win.frameElement,g=A.getPositionRelativeToMainView(p,A.getParentWindow(p),!1);g&&(u.x+=g.x-d.x,u.y+=g.y-d.y)}a.log(s,n,{ps:u,x:c})}}},i=250;if(this.browser.isMobile){if(e=null,i=100,this.isTop){this.lastOrientation={alpha:0,beta:0,gamma:0},r.Bind(window,"record:deviceorientation",r.proxy(function(t){if(r.isDefined(t.alpha)){var e=Math.round(t.alpha),i=Math.round(t.beta),s=Math.round(t.gamma),n=10,o=this.recorder;(Math.abs(e-this.lastOrientation.alpha)>n||Math.abs(i-this.lastOrientation.beta)>n||Math.abs(s-this.lastOrientation.gamma)>n)&&(this.lastOrientation.alpha=e,this.lastOrientation.beta=i,this.lastOrientation.gamma=s,o.getLogger().log(o,f.EVENT_TYPES.ORIENTATION,{ot:{a:e,b:i,
g:s}}))}},this)),this.doOrientationChange=r.proxy(function(t){var e=this.recorder.win.document.documentElement,i=A.getDocSize(this.recorder.doc),s=0;Math.abs(window.orientation)>0&&(s=1),this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.ORIENTATION_CHANGE,{ps:r.getScroll(this.recorder.win),oc:{isL:s,ww:e.clientWidth,wh:e.clientHeight,dw:i.width,dh:i.height,wiw:window.innerWidth,wih:window.innerHeight}})},this),r.Bind(window,"record:orientationchange",this.doOrientationChange),this.doOrientationChange();for(var s=function(t,e,i){var s=[];if(r.isDefined(t.touches))for(var n=0;n<t.touches.length;n++){var o=t.touches[n];s.push({x:o.pageX,y:o.pageY})}i.getLogger().log(i,f.EVENT_TYPES.TOUCH,{ts:s})},n=["start","end","cancel","leave","move"],a=function(t){return function(e){s(e,"",t)}},h=0;h<n.length;h++)r.Bind(window,"record:touch"+n[h],a(this.recorder));r.Bind(window,"record:touchstart",r.proxy(function(){this.EmergencySendRequired.fire()},this.recorder))}}else{var c=this.browser.isIE?this.recorder.win.document:this.recorder.win;this.isTop?this.mouseMoveCapture=new o(this.recorder,c,"record:mousemove",200,e,(!0)):this.mouseMoveCapture=this.recorder.getTop().eventcap.mouseMoveCapture.merge(this.recorder,c,"record:mousemove",e,!0),r.Bind(this.recorder.win.document,"record:mousedown",r.proxy(function(t){this.mHandler.call(this.ctx,t,null,this.rec,f.EVENT_TYPES.MOUSE_CLICK)},{ctx:this,rec:this.recorder,mHandler:e}))}if(this.scrollCapture=new o(this.recorder,this.recorder.win,"record:scroll",i,function(t){return function(i,s,n){var o=!0;if(n.win==n.win.top)if(m._browser.isMobile){var a=A.getDocSize(n.doc),h={cw:window.innerWidth,ch:window.innerHeight,w:a.width,h:a.height},c={z:h,ps:r.getScroll(n.win)};o=!1,n.getLogger().log(n,f.EVENT_TYPES.ZOOM,c)}else e&&t.call(this,i,s,n);o&&n.getLogger().log(n,f.EVENT_TYPES.FRAME_SCROLL,{ps:r.getScroll(n.win)})}}(e)),this.isTop){this.browser.isMobile||(this.recorder.isMousedOverWindow=!0,r.Bind(this.recorder.win.document,"record:mouseover",function(t,e){return function(t){!e||e.isMousedOverWindow||t.relatedTarget||t.fromElement||(e.getLogger().log(e,f.EVENT_TYPES.WINDOW_MOUSEOUT_MOUSEENTER,{st:1}),e.isMousedOverWindow=!0)}}(this,this.recorder)),r.Bind(this.recorder.win.document,"record:mouseout",r.proxy(function(t){t=t?t:this.recorder.win.event;var e,i=this.recorder,r=t.relatedTarget||t.toElement;try{r&&(e=r.nodeName)}catch(t){}i&&i.isMousedOverWindow&&(!r||e&&"HTML"==e)&&(i.getLogger().log(i,f.EVENT_TYPES.WINDOW_MOUSEOUT_MOUSEENTER,{st:0}),i.isMousedOverWindow=!1,i.EmergencySendRequired.fire())},this)));var l=function(t){return function(){var e=A.getDocSize(t.doc);t.docSize&&t.docSize.width==e.width&&t.docSize.height==e.height||(t.docSize=e,t.getLogger().log(t,f.EVENT_TYPES.DOC_SIZE,{sz:{w:e.width,h:e.height}}))}}(this.recorder);l.apply(this,[]),this.recorder.DomUpdated.subscribe(l),l=null}e=null},g.MAX_UPDATE_NODE_BINDING_EXECUTION_TIME=500,g.prototype.updateNodeBinding=function(t,e,i){for(var s=+new Date,n=t.querySelectorAll("input, select, textarea"),o=this.inputCaptures,a=function(t){return function(){setTimeout(r.proxy(function(){for(var t=0;t<this.length;t++)this[t].serialize()},t),1)}},h=n.length-1;h>=0;h--){if(r.now()-s>g.MAX_UPDATE_NODE_BINDING_EXECUTION_TIME){this.recorder.logger.log(this.recorder,f.EVENT_TYPES.INCOMPLETE_INPUT_CAPTURE,{});break}var c=n[h];if(c._fsrTracker)for(var l=o.length-1;l>=0;l--){var d=o[l];if(d.input==c&&d.hasChanged()){d.serialize();break}}else o[o.length]=new x(this.recorder,c),"reset"==c.getAttribute("type")&&r.Bind(c,"record:click",a(o));c=null}!i&&this.browser.isIE&&this.mutation.setNodeSpecificBindings(t,e),n=null,o=null,t=null},g.prototype.dispose=function(){this.mutation.dispose(),this.mutation=null,this.recorder=null,this.inputCaptures=null,this.inputReserialize=null;var t,e=n._trackers;for(t=0;t<e.length;t++)e[t].dispose(),e.splice(t--,1);var i=D;for(t=0;t<i.length;t++)i[t].dispose(),i.splice(t--,1)};var m={_browser:null,_cacheList:[]};m.getCacheableObject=function(t,e){var i=m._browser.isMobile;e&&e.join&&(e=e.join(","));var s,n={},o=m,a=o._cacheList;for(s=a.length-1;s>=0;s--)if(a[s].str==t){n.uid=a[s].uid;break}if(!r.isDefined(n.uid)){if(n.uid=r.generateGUID(),n.kl=e,e&&t.length>100)for(s=a.length-1;s>=0;s--)if(a[s].kl==e){var h=d(a[s].str,t);n.diff={uid:a[s].uid,d:h};break}r.isDefined(n.diff)?(!i||a.length<500)&&(a[a.length]={str:t,uid:n.uid,kl:n.kl}):(n.str=t,(!i||a.length<500)&&(a[a.length]=n))}return n};var y={iFrameXpaths:{}};y.performFrameBindings=function(t,e){if(!i.advancedSettings.skipIframes){var s,n,o,a,c,l,d=(e||t.win.document).querySelectorAll("iframe"),u=function(t){return function(){t.dispose()}},f=function(t){return function(e){y.bindToFrameLoad(e,t)}};for(s=0;s<d.length;s++){if(n=d[s],o=n._fsrB||n.getAttribute("_fsrB"),!o&&!y.iFrameXpaths[k.getMapping(n)]){var p=this.testFrameOrigin(n),g=this.testFrameSrc(n);if(g&&p){if(y.iFrameXpaths[k.getMapping(n)]=!0,n.setAttribute("_fsrB",!0),a=this.getFrameWindow(n),!a)return;if(c=this.getFrameDocument(a,!1),l=!1,c){this.unbindInternalIframes(c);try{"complete, loaded".indexOf(c.readyState)>-1&&(l=!0)}catch(t){}l&&(r.isDefined(a.recorder)?a.recorder.serializeDom():(a.recorder=new W(t.stg,t.browser,a,k.getMapping(n),t,t.config),t.childRecorders.push(a.recorder),r.Bind(a,"unload",u(a.recorder))))}c=null,a=null}else g&&!p&&(y.iFrameXpaths[k.getMapping(n)]=!0,n.setAttribute("_fsrB",!0),h.TrackFrame(k.getMapping(n),n,t));r.BindOnce(n,"record:load",f(t))}n=null}d=null,t=null}},y.bindToFrameLoad=function(t,e){var i,s=t.originalTarget||t.target||t.srcElement;s&&this.testFrameSrc(s)&&y.testFrameOrigin(s)&&(i=y.getFrameWindow(s),y.getFrameDocument(i)&&(r.isDefined(i.recorder)||(i.recorder=new W(e.stg,e.browser,i,k.getMapping(s),e,e.config,e.isIframeMode),e.childRecorders.push(i.recorder),i.recorder.ready.subscribe(r.proxy(function(){r.Bind(i,"unload",this.dispose)},i.recorder),!0,!0))),i=null),s=null,e=null,t=null},y.testFrameSrc=function(t){var e,i=["javascript:","shim.gif","about:blank"];for(e=0;e<i.length;e++)if(t.src.indexOf(i[e])>-1)return!1;return!0},y.testFrameOrigin=function(t,e){var i=t.getAttribute("src");if(!i||0===i.indexOf(" "))return!1;var s=t.src;return r.testSameDomain(e||window.location.href,s)},y.unbindInternalIframes=function(t){var e,i=t.querySelectorAll("iframe[_fsrB='true']");for(e=0;e<i.length;e++)i[e]._fsrB=!1},y.getFrameWindow=function(t){var e;return t&&t.contentWindow?e=t.contentWindow:t&&t.contentDocument&&t.contentDocument.defaultView&&(e=t.contentDocument.defaultView),e&&e!=e.top?e:null},y.getFrameDocument=function(t){var e;try{return e=t.document}catch(t){return!1}};var _=function(t,e,config){var i=_,r=t.document;return i.ProcessHTML(i._getDocType(r)+r.querySelectorAll("html")[0].outerHTML,r,e,!!config.advancedSettings.pii.useWhiteListing,config)},T=_;_.ProcessHTML=function(t,e,i,r,config){return m.getCacheableObject(_._scrubHTML(t,r,config),i)},_._scrubHTML=function(t,e,config){var i,s=_,n=config.advancedSettings||{};if(t=r.isArray(t)?t[0]:t||"",n.regexScrub)for(i=0;i<n.regexScrub.length;i++)t=t.replace(n.regexScrub[i],"");return t=s._removeInnerScriptContent(t),t=s._removeZeroWidthEntities(t),t=s._fixPreTags(t),t=s._fixViewState(t),t=s._stripOptionTags(t),t=s._convertSpecialChars(t,config),t=s._stripInputValues(t),t=e?s._whiteListBlock(t,e):s._maskFSRHiddenBlocks(t,e),e||r.isDefined(n.keepComments)&&n.keepComments===!0||(t=s._removeComments(t)),t};var S=function(t){return t[0].indexOf("fsrHiddenBlock")<0?"":t[0]};_._removeComments=function(t){return/<!--/gim.test(t)?T._superReplace(t,/(<!--)[\w\W]*?(-->)/gim,S):t},_._convertSpecialChars=function(t,config){if(config.advancedSettings){var e,i=config.advancedSettings.specialMappings;if(r.isDefined(i))for(e=0,len=i.length;e<len;e++)t=t.replace(i[e][0],i[e][1])}return t},_._removeInnerScriptContent=function(t){return/script/gim.test(t)?T._superReplace(t,/(<script[^>]*?>)[\s\S]*?(<\/[\w]*script>)/gim,function(t){return t[1]+t[2]}):t},_._maskFSRHiddenBlocks=function(t,e){return e?this._superReplace(t,new RegExp(".+","mig"),T._maskBlock):t.indexOf("fsrHiddenBlock")>=0?_._superReplace(t,new RegExp("<!--(\\W)*fsrHiddenBlockStart[\\w\\W]*?fsrHiddenBlockEnd(\\W)*-->","mig"),T._maskBlock):t},_._removeZeroWidthEntities=function(t){return t.replace(/(\u200B)|(\u200C)|(\u200D)|(\uFEFF)/g,"")},_._fixPreTags=function(t){return t.indexOf("/pre")>-1||t.indexOf("/PRE")>-1?T._superReplace(t,new RegExp("[\\s\\S]*?(?:\\/pre\\s*>)|[\\s\\S]+","mig"),T._removeFormat):t},_._fixViewState=function(t){return t.indexOf("VIEWSTATE")>-1?t.replace(/<input[^>]*name=["']?__VIEWSTATE[^>]*>/gim,'<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" />'):t};var w=function(t){var e=t[0].match(/<\/select[^>]*>/gim);return e?t[0]:""};_._stripOptionTags=function(t){return/select/gim.test(t)?T._superReplace(t,/(<option[^>]*>[\s\S]*?<\/[\w]*option>)/gim,w):t};var E=function(t,e,i){if(e)return e+i.replace(/[\w\d\s]/g,"*")+'"'};_._stripInputValues=function(t){return t.length>0&&/value/.test(t)?t.replace(/(<(?:\s)*?input(?:[^>]+)value=\")([^>\"]*)\"/gim,E):t},_._superReplace=function(t,e,i){for(var s,n=e.exec(t),o="",a=0;r.isDefined(n);)o+=t.substring(a,n.index),s=i(n),o+=s,a=n.index+n[0].length,n=e.exec(t);return o+=t.substring(a,t.length)};var v=function(t,e,i,r){return i||r||"*"};_._maskBlock=function(t){var e=t instanceof Array?t[0]:t||"";return e.length>0?e.replace(/(>)|(&[^\s;]*;)|(<[^<>]*?>)|(<)|\w/g,v).replace(/&((?!nbsp| |amp).)*?;/g,"*"):""},_._removeFormat=function(t){var e=0,i=t[0];return i&&(i="",e=_._regexIndexOf(t[0],new RegExp("<\\s*?pre","mig")),i+=t[0].substring(0,e).replace(/\t/g," ").replace(/\s+/g," "),i+=t[0].substring(e)),i},_._regexIndexOf=function(t,e,i){var r=t.substring(i||0).search(e);return r>=0?r+(i||0):r},_._regexLastIndexOf=function(t,e,i){for(var r=i,s=_.regexIndexOf(t,e,r);s>-1;)r=s,s=_.regexIndexOf(t,e,r+1);return r},_._getDocType=function(t){var e,i="",s=t.doctype,n=t.childNodes,o=0;if(g._browser.isIE&&("CSS1Compat"!=t.compatMode||5==t.documentMode))return i;if(s){try{if(e=(new XMLSerializer).serializeToString(s).toString(),e&&e.length>0)return e}catch(t){}i="<!DOCTYPE HTML",s.publicId&&(i=i+' PUBLIC "'+s.publicId+'"'),s.systemId&&(i=i+' SYSTEM "'+s.systemId+'"'),i+=">"}else if(n[o].text){for(;n[o].text&&(0===n[o].text.indexOf("<!--")||0===n[o].text.indexOf("<?xml"));)o++;r.isDefined(n[o].text)&&0===n[o].text.toLowerCase().indexOf("<!doctype")&&(i=n[o].text)}return i},_._whiteListBlock=function(t,e){var i=t.indexOf("<!--fsrWhiteListStart"),r="";return e?i>=0?r+=_._maskBlock(t.substring(0,i))+_._superReplace(t.substring(i),new RegExp("<!--(\\W)*fsrWhiteListEnd(\\W)*-->([\\W\\D\\S](?!!--(\\W)*fsrWhiteListStart(\\W)*-->))*","mig"),_._maskBlock):this._superReplace(t,new RegExp(".+","mig"),_._maskBlock):t};var b=function(t){this._elementCache={},this._callbackTimer=null,this.recorder=t,this.cacheIndex=0,t=null};b.prototype.dispose=function(){r.superDispose(this._elementCache),this._elementCache=null,this.recorder=null,clearTimeout(this._callbackTimer)},b.prototype.push=function(t,e,i,s){var n={t:t,c:e,i:i,p:s,d:r.now()};s=s||"",t&&1!=t.nodeType&&(t=t.parentNode),t&&this._elementCache&&(t._fsrKey||(t._fsrKey={id:"_"+this.cacheIndex++}),this._elementCache[t._fsrKey.id+s.toLowerCase()]=n,this._callbackTimer||(this._callbackTimer=setTimeout(r.proxy(function(){this.handleEvents()},this),1e3)),t=null,e=null)},b.prototype.handleEvents=function(){this._callbackTimer=null;try{this.recorder.win.document}catch(t){return}var t,e=this._elementCache,i=r.now();for(var s in e)t=e[s],t._fsrKey=null,"object"==typeof t&&t.t&&t.t.nodeName&&"svg"!=t.t.nodeName&&(t.c(i-t.d),r.superDispose(t),t=null);r.superDispose(this._elementCache),this._elementCache={},e=null},b.prototype.accelerate=function(){this.handleEvents()};var C=function(t){this.config=t.config,this.recorder=t,this.mutationSynonym=window.MutationObserver?"MutationObserver":!!window.WebKitMutationObserver&&"WebKitMutationObserver",this.domMethodCopies=[],this.domMethodRewrites=[],this.domUpdateThrottler=new b(this.recorder),this.supportsDomPrototypes=!g._browser.isIE||(r.isDefined(t.win.Element)||r.isDefined(t.win.HTMLElement))&&!i.useEleMutation,this.setupMutationObserver(this.recorder,this)||g._browser.isIE&&(this.saveDomMutationMethods(),this.supportsDomPrototypes&&this.overrideDomPrototype(),this.setNodeSpecificBindings(this.recorder.win.document),this.recorder.DomUpdated.subscribe(r.proxy(function(t){this.setNodeSpecificBindings(t),t=null},this))),t=null};C.mutatorInfo={ignoreNodeContentsList:"input,select,img,link,meta,title,textarea,br,hr,script".split(","),watchNodeList:"html,head,header,h1,h2,h3,h4,h5,article,aside,section,details,footer,figure,nav,body,div,span,ul,li,dd,dt,ol,dl,tr,td,span,form,img,a,area,iframe,fieldset,select,input,textarea,table,label",svgWatchNodeList:"svg,defs,g,symbol,use,circle,ellipse,line,polygon,polyline,rect,linearGradient,radialGradient,animate,animateColor,animateMotion,animateTransform,set,stop,a,altGlyphDef,clipPath,color-profile,cursor,filter,font,font-face,foreignObject,image,marker,mask,pattern,switch,text,view,path,clippath",domRewriteList:"appendChild,removeChild,removeNode,insertAdjacentHTML,replaceChild,replaceNode,swapNode,insertBefore".split(",")};var M=C.mutatorInfo;C.prototype.setupMutationObserver=function(t,e){var i=this,r=this.mutationSynonym,s=e.domAttrModifiedHandler(t,e,i.config,!0),n=e.domSubtreeModifiedHandler(t,e,i.config,!0);if(r)return e.mutationObserver=new window[r](function(t){t.forEach(function(t){var e;switch(t.type){case"attributes":N(t.attributeName,t.target.tagName)&&(e={target:t.target,attrName:t.attributeName,newValue:t.target.getAttribute(t.attributeName)},s(e)),e=null;break;case"characterData":e={target:t.target.parentNode},n(e);break;case"childList":L(t)&&(e={target:t.target},n(e),e=null)}})}),this.mutationConfig={attributes:!0,childList:!0,subtree:!0},e.mutationObserver.observe(t.win.document,this.mutationConfig),!0};var L=function(t){var e,i;if(t.addedNodes&&t.addedNodes.length>0)for(e=0;e<t.addedNodes.length;e++)if(i=t.addedNodes[e],"SCRIPT"!=i.tagName)return!0;if(t.removedNodes&&t.removedNodes.length>0)for(e=0;e<t.removedNodes.length;e++)if(i=t.removedNodes[e],"SCRIPT"!=i.tagName)return!0},N=function(t,e){return!(!t||"_"==t.substr(0,1)||"on"==t.substr(0,2)||"href"==t||"script,meta,title".indexOf(e)>=0)&&(!(0===t.indexOf("siz")||0===t.indexOf("jQuery"))||0===t.indexOf("_fsrb"))};C.prototype.propertyChangeHandler=function(t){var e=t.propertyName,i=t.srcElement,config=this.config;if(!N(e,i.tagName))return void(i=null);if("innerHTML"==e||"innerText"==e||"outerHTML"==e)("outerHTML"==e||i.tagName&&"select"==i.tagName.toLowerCase())&&(i=i.parentNode),this.mutationSynonym||this.domUpdateThrottler.push(i,function(t,e){return function(i){var r=t.recorder,s=r.masker._tagDynamicMaskNodes(e,!1,r.win),n=k.getMapping(e),o=r.getLogger();o&&(o.log(r,f.EVENT_TYPES.DOM_MUTATION_NODE_MODIFIED,{x:o.logXPath(r,n),h:_.ProcessHTML(e.innerHTML,r.win.document,n,s,config)},null,i),t._handleDomUpdateIfNecessary(e)),e=null,t=null,s=null}}(this,i),!1);else if("on"!=e.substring(0,2)){for(var s=0;s<M.domRewriteList.length;s++)if(e==M.domRewriteList[s])return;if("on"==e.substr(0,2).toLowerCase())return;var n=i[e];e.indexOf("style.")>-1&&(e="style",n=i.getAttribute(e)),this.mutationSynonym||this.domUpdateThrottler.push(i,function(t,i){return function(s){if(t.recorder.masker._tagDynamicMaskNodes(i,!1,t.recorder.win),"style"==e){var o=i.getAttribute("style")||i.style;o&&o.cssText&&(n=o.cssText)}var a=t.recorder.getLogger(),h=k.getMapping;if(a)if("style"==e){n&&"null"!=n||(n="");var c=a.logXPath(t,h(i,null,"id"==e)),l=i.getAttribute("style")||i.style;l&&a.log(t.recorder,f.EVENT_TYPES.DOM_MUTATION_NODE_ATTR_MODIFIED,{a:e,v:"undefined"!=typeof l.cssText?l.cssText:l+"",x:c},null,s)}else{var d=i.tagName.toLowerCase();"object"==typeof n||"value"==e&&"input"==d&&"hidden"==i.type||r.inArray(d,["input","select","textarea"])&&!r.inArray(e,["className","cols","rows","class","width","height","align"])||a.log(t.recorder,f.EVENT_TYPES.DOM_MUTATION_NODE_ATTR_MODIFIED,{a:e,v:n+"",x:a.logXPath(t,h(i,null,"id"==e))},null,s)}t=null,a=null,i=null}}(this,i),!0,e)}i=null,t=null},C.prototype.domSubtreeModifiedHandler=function(t,e,i){return function(t){var s,n=t.originalTarget||t.target||t.srcElement,o=n.tagName?n.tagName.toLowerCase():"";if(r.inArray(o,M.ignoreNodeContentsList))"select"==o&&null!==n._fsrTracker&&e.domUpdateThrottler.push(n,function(t){return function(){t._fsrTracker.serialize()}}(n),!1);else{if(i.advancedSettings&&i.advancedSettings.svgCaptureEnabled&&r.inArray(o,M.svgWatchNodeList.split(","))){for(s=n;!s.innerHTML&&s.parentNode;)s=s.parentNode;n=s}e.domUpdateThrottler.push(n,function(t,e){return function(i){e._doDomUpdateWorkWithLog(t,i)}}(n,e),!1)}}};var I=function(t,e,i,r,s,n){return function(s){var n,o=r.getLogger(),a=k.getMapping;if(o)if("class"==e&&r.masker._tagDynamicMaskNodes(t,!0,r.win),"style"==e){n=o.logXPath(r,a(t,null,"id"==e));var h=t.getAttribute("style")||t.style;h&&"_fsrb"!=e&&o.log(r,f.EVENT_TYPES.DOM_MUTATION_NODE_ATTR_MODIFIED,{a:e,v:"undefined"!=typeof h.cssText?h.cssText:h+"",x:n},null,s)}else if("_fsrb"!=e&&("value"!=e||"input"!=t.tagName.toLowerCase()||"hidden"!=t.type)&&"on"!=e.substr(0,2).toLowerCase()){var c=a(t,null,"id"==e);n=o.logXPath(r,c),o.log(r,f.EVENT_TYPES.DOM_MUTATION_NODE_ATTR_MODIFIED,{a:e,v:i,x:n},null,s)}}};C.prototype.domAttrModifiedHandler=function(t,e,i){return function(r){var s=r.attrName,n=r.newValue,o=r.originalTarget||r.target||r.srcElement;"on"==s.substr(0,2)||"script,meta,title".indexOf(o.tagName)>-1||(e.domUpdateThrottler.push(o,I(o,s,n,t,e,i),!0,s),o=null)}},C.prototype._doDomUpdateWorkWithLog=function(t,e){var i=this.recorder;3==t.nodeType&&(t=t.parentNode);var r=k.getMapping(t);if(0===r[0].indexOf("html")){var s=this.recorder.masker._tagDynamicMaskNodes(t,!1,i.win),n=t.innerHTML?_.ProcessHTML(t.innerHTML,i.win.document,r,s,this.config):{},o=i.getLogger();o&&(o.log(i,f.EVENT_TYPES.DOM_MUTATION_NODE_MODIFIED,{x:o.logXPath(i,r),h:n},null,e),this._handleDomUpdateIfNecessary(t))}},C.prototype._handleDomUpdateIfNecessary=function(t){var e=t.tagName?t.tagName.toLowerCase():"";1!=t.nodeType||r.inArray(e,C.ignoreNodeContentsList)||this.recorder.DomUpdated.fire(t)},C.prototype.setNodeSpecificBindings=function(t){for(var e=t.querySelectorAll(M.watchNodeList+", "+M.svgWatchNodeList),i=function(t){return function(e){t.propertyChangeHandler(e)}}(this),s=e.length-1;s>=0;s--){var n=e[s];if(r.BindOnce(n,"record:propertychange",i,!0,!0),!this.supportsDomPrototypes){var o,a=n.getAttribute("_fsrRewrite");if(!a){n.setAttribute("_fsrRewrite","true");for(var h=M.domRewriteList.length-1;h>=0;h--)o=M.domRewriteList[h],n[o]=this.domMethodRewrites[o]}}n=null}e=null,t=null,i=null},C.prototype.methodRewriter=function(t,e){var config=this.config;return function(){var s,n=this.parentNode,o=e.domMethodCopies[t];if(o){if("BODY"==this.tagName)try{s=o(arguments[0],arguments[1])}catch(t){s=o.apply(this,arguments)}else s=o.apply(this,arguments);return n&&1==n.nodeType&&e.domUpdateThrottler.push(n,function(t,e){return function(s){var n,o,a=t.recorder.masker._tagDynamicMaskNodes(e,!1,t.recorder.win),h=k.getMapping(e),c=t.recorder.getLogger();if(c){if(n=e.tagName.toLowerCase(),i.svgCaptureEnabled&&r.inArray(n,M.svgWatchNodeList.split(","))){for(o=e;!o.innerHTML;){if(!o.parentNode)return;o=o.parentNode}e=o}c.log(t.recorder,f.EVENT_TYPES.DOM_MUTATION_NODE_MODIFIED,{x:c.logXPath(t.recorder,h),h:_.ProcessHTML(e.innerHTML,t.recorder.win.document,h,a,config)},null,s),t._handleDomUpdateIfNecessary(e)}e=null,t=null,a=null}}(e,n),!1),s}}},C.prototype.saveDomMutationMethods=function(){var t,e;for(e=M.domRewriteList.length-1;e>=0;e--)t=M.domRewriteList[e],this.domMethodCopies[t]=this.recorder.win.document.body[t],this.domMethodRewrites[t]=this.methodRewriter(t,this)},C.prototype.overrideDomPrototype=function(){var t,e,i=this.recorder.win,s=r.isDefined(i.Element)?i.Element.prototype:void 0,n=r.isDefined(i.HTMLElement)?i.HTMLElement.prototype:void 0;for(e=M.domRewriteList.length-1;e>=0;e--)t=M.domRewriteList[e],s&&(s[t]+"").indexOf("native")>-1&&(s[t]=this.domMethodRewrites[t]),n&&(n[t]+"").indexOf("native")>-1&&(n[t]=this.domMethodRewrites[t])},C.prototype.removeDomPrototypeOverrides=function(){var t,e,i=this.recorder.win,s=r.isDefined(i.Element)?i.Element.prototype:void 0,n=r.isDefined(i.HTMLElement)?i.HTMLElement.prototype:void 0;for(e=M.domRewriteList.length-1;e>=0;e--)t=M.domRewriteList[e],s&&s[t]&&delete s[t],n&&n[t]&&delete n[t]},C.prototype.dispose=function(){this.domUpdateThrottler&&(this.domUpdateThrottler.accelerate(),this.domUpdateThrottler.dispose()),r.superDispose(this.domMethodCopies),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.supportsDomPrototypes&&g._browser.isIE&&this.removeDomPrototypeOverrides(),this.domMethodCopies=null,this.domMethodRewrites=null,this.recorder=null};var D=[],x=function(t,e){if(!e._fsrTracker){e._fsrTracker=this,D.push(this),this.input=e,this.recorder=t;var i="";if(i=e.getAttribute("type")?e.getAttribute("type").toLowerCase():"text",this._isTextInput()&&(this.lastValue=e.getAttribute("value")||""),((!this._isTextInput()||e.value)&&("checkbox"!=i||e.checked)||e.type&&"select-one"==e.type)&&this.serialize(!0),r.Bind(e,"record:scroll",r.proxy(function(){this.input&&this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.SCROLL_EL,{t:i,x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input)),ps:{x:this.input.scrollLeft,y:this.input.scrollTop}})},this)),r.Bind(e,"record:focus",r.proxy(function(){this.input&&(this._isTextInput()&&(this._updateCaret(),this._caretMonitor=setInterval(r.proxy(function(){this.input&&this._updateCaret()},this),350)),this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.FOCUS_BLUR,{t:i,st:1,x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input))}))},this)),r.Bind(e,"record:blur",r.proxy(function(t){this.input&&(this._isTextInput()&&clearInterval(this._caretMonitor),this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.FOCUS_BLUR,{t:i,st:0,x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input))}))},this)),"checkbox"==i||"radio"==i){var s=r.proxy(function(){this.input&&this._lastCheckedState!=this.input.checked&&(this._lastCheckedState=this.input.checked,this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.VALUE_CHANGED,{t:i,b:this.input.checked,x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input))}))},this);r.Bind(e,"record:click",s),r.Bind(t.win,"record:click",s)}"checkbox"!=i&&"radio"!=i&&r.Bind(e,"record:change",r.proxy(function(){if(this.input){this._lastSelectListContents!=this.input.innerHTML&&this.serialize(),this.lastValue=this.input.value;var t=this.input.selectedOptions,e="";t&&t.length>0&&!this._isSecret()&&(e=t[0].innerText),this.recorder.getLogger().log(this.recorder,f.EVENT_TYPES.VALUE_CHANGED,{t:i,si:this.input.selectedIndex,x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input)),v:e})}},this)),this._isTextInput()&&(this.lastValue=this.input.value,r.Bind(e,"record:keydown",function(t){return function(e){t.input&&(g._browser.isIE&&(e={keyCode:e.keyCode,charCode:e.charCode}),setTimeout(function(t,e){return function(){t._updateCaret();var r=0;if("number"==typeof e.keyCode?r=e.keyCode:"number"==typeof e.which?r=e.which:"number"==typeof e.charCode&&(r=e.charCode),Math.abs(t.lastValue.length-t.input.value.length)>1||t.lastCaretInfo.e-t.lastCaretInfo.s>1)t.serialize();else{0===r&&32==e.charCode&&(r=e.charCode);var s=t.recorder.getLogger().logXPath(t.recorder,k.getMapping(t.input));r<=46||r>=91&&r<96||r>=112&&r<=145?t.recorder.getLogger().log(t.recorder,f.EVENT_TYPES.KEY_PRESS,{t:i,xp:s,sk:r,ps:{x:t.input.scrollTop,y:t.input.scrollLeft}}):t.recorder.getLogger().log(t.recorder,f.EVENT_TYPES.KEY_PRESS,{t:i,xp:s,v:t._filterTextIfApplicable(t.input.value.substr(t.lastCaretInfo.c-1,1)),ps:{x:t.input.scrollTop,y:t.input.scrollLeft}})}t.lastValue=t.input.value}}(t,e),1))}}(this))),t=null,e=null}};x.prototype.hasChanged=function(){return this._lastCheckedState!=this.input.checked||this.lastValue!=this.input.value},x.prototype._filterTextIfApplicable=function(t){return t&&this._isSecret()?t.replace(/[^ \n\r\t]/g,"*"):t},x.prototype._isSecret=function(){var t=this.input.getAttribute("class")||this.input.getAttribute("className");return!(t&&t.indexOf("fsrVisible")>-1||"reset,submit,button".indexOf(this.input.getAttribute("type"))>-1)},x.prototype._isTextInput=function(){var t="text",e=this.input.tagName.toLowerCase(),i=["text","password","textarea","number","email","url","search","color","tel",""];return this.input.getAttribute("type")&&(t=this.input.getAttribute("type").toLowerCase()),("textarea"==e||r.inArray(t,i))&&"select"!==e},x.prototype.serialize=function(t){var e=this.input.tagName.toLowerCase(),i=this.input.getAttribute("type");if(i||(i=this.input.tagName.toLowerCase(),"input"==i&&(i="text")),"hidden"!=i){if(t){if(!("radio"!=i&&"checkbox"!=i||this.input.checked))return void(this._lastCheckedState=!1);if(("text"==i||"password"==i||"textarea"==e)&&""===this.input.value)return}var r=this.recorder.getLogger(),s=f.EVENT_TYPES.INPUT_SERIALIZE,n=r.logXPath(this.recorder,k.getMapping(this.input));switch(i="select,textarea".indexOf(e)>-1?e:i){case"textarea":r.log(this.recorder,s,{t:i,x:n,v:this._filterTextIfApplicable(this.input.value)||"",wt:A.getStyle(this.input,this.recorder.win,"width"),ht:A.getStyle(this.input,this.recorder.win,"height")});break;case"radio":case"checkbox":!this.input.checked&&t||(r.log(this.recorder,s,{t:i,x:n,b:this.input.checked}),this._lastCheckedState=this.input.checked);break;case"select":for(var o=[],a=0;a<this.input.options.length;a++)o[o.length]={v:this._filterTextIfApplicable(this.input.options[a].value),t:this._filterTextIfApplicable(this.input.options[a].text)};!this.input.multiple&&this._isSecret()&&o.length>1&&(o.length=1),r.log(this.recorder,s,{t:i,x:n,sz:{w:this.input.offsetWidth,h:this.input.offsetHeight},o:o,si:this.input.options.selectedIndex}),this._lastSelectListContents=this.input.innerHTML;break;default:r.log(this.recorder,s,{t:i,x:n,v:this._filterTextIfApplicable(this.input.value)||""})}}},x.prototype._updateCaret=function(){var t=this._getCaretInfo(this.input);this.lastCaretInfo&&this.lastCaretInfo.s==t.s&&this.lastCaretInfo.e==t.e&&this.lastCaretInfo.c==t.c||setTimeout(function(t,e){return function(){t.recorder.getLogger().log(t.recorder,f.EVENT_TYPES.CARET_INFO,e)}}(this,{x:this.recorder.getLogger().logXPath(this.recorder,k.getMapping(this.input)),ci:t}),1),this.lastCaretInfo=t},x.prototype._getCaretInfo=function(){var t=this.input,e=t.value,i=t.ownerDocument,r={s:0,e:0,c:0};if(g._browser.isIE){if("textarea"==t.tagName.toLowerCase()&&i.selection){e.charCodeAt(e.length-1)<14&&(e=e.replace(/34/g,"")+String.fromCharCode(28));var s=i.selection.createRange(),n=s.duplicate();n.moveToElementText(t),n.setEndPoint("StartToEnd",s),r.e=e.length-n.text.length,n.setEndPoint("StartToStart",s),r.s=e.length-n.text.length,r.c=r.e,e.substr(e.length-1)==String.fromCharCode(28)&&(e=e.substr(0,e.length-1));var o=e.substr(0,r.s).split("\n").length-1,a=e.substr(0,r.c).split("\n").length-1,h=e.substr(0,r.e).split("\n").length-1;r.c-=a,r.s-=o,r.e-=h}else if(i.selection){var c=i.selection.createRange(),l=c.duplicate();r.s=0-l.moveStart("character",-1e5),r.e=r.s+c.text.length,r.c=r.e}}else try{r.s=t.selectionStart,r.e=t.selectionEnd,r.c=r.e}catch(t){}return!r.s&&r.s<0&&(r={s:0,e:0,c:0}),r},x.prototype.dispose=function(){this.input._fsrTracker=null,this.recorder=null,this.lastValue=null,this.input=null,this.lastCaretInfo=null,this._lastSelectListContents=null,clearTimeout(this._caretMonitor)};var k={};k.getMapping=function(t,e,i){if(e=e||[],t.parentNode&&(e=k.getMapping(t.parentNode,e)),1==t.nodeType){var r,s;if(t.previousSibling){r=1,s=t.previousSibling;do 1==s.nodeType&&s.nodeName==t.nodeName&&r++,s=s.previousSibling;while(s);1==r&&(r=null)}else if(t.nextSibling){s=t.nextSibling;do 1==s.nodeType&&s.nodeName==t.nodeName?(r=1,s=null):(r=null,s=s.previousSibling);while(s)}e.push(O(t,r,!!i))}return e};var O=function(t,e,i){var r;return t.getAttribute&&(r=t.getAttribute("id"),r&&r.indexOf("yui_")>-1&&(r=null)),t.nodeName.toLowerCase()+(r&&!i?"[@id='"+r+"']["+(e||1)+"]":e>0?"["+e+"]":"")};k.getNodeXPathPosition=function(t){for(var e=t.nodeType,i=t.tagName,r=t.parentNode,s=0,n=r.childNodes,o=n.length,a=0;o>s&&n[s];){if(n[s].nodeType==e&&(i&&i==n[s].tagName||!i)&&(a++,n[s]==t))return a;s++}return 0};var A={};A.nodeBelongsTo=function(t,e){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(;t.parentNode;){if(t==e||t==e.body)return!0;t=t.parentNode}return!1},A.getEncoding=function(){return g._browser.isIE?window.document.charset:window.document.characterSet},A.getParentWindow=function(t){var e=t;if(t){if(t._pw)return t._pw;if(t.ownerDocument&&t.ownerDocument.defaultView)return t.ownerDocument.defaultView;for(;t.parentNode||t.document;){if(t.document)return e._pw=t,t;t=t.parentNode}}},A.getStyle=function(t,e,i){if(!e)return"";var r="",s=e.document.defaultView;return s&&s.getComputedStyle&&s.getComputedStyle(t,"")?r=s.getComputedStyle(t,"").getPropertyValue(i):t.currentStyle&&(i=i.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()}),r=t.currentStyle[i]),r},A.getPosition=function(t,e){for(var i=0,r=0,s=A.getStyle;t;)i+=t.offsetTop+(parseFloat(s(t,e,"borderTopWidth"))||0),r+=t.offsetLeft+(parseFloat(s(t,e,"borderLeftWidth"))||0),t=t.offsetParent;return{x:r,y:i}},A.getPositionRelativeToMainView=function(t,e,i){for(var s,n=!1;!n&&e;){n=e.parent==e;var o=A.getPosition(t,e),a=r.getScroll(e);i&&!n&&(o.x-=a.x,o.y-=a.y),s?(s.x+=o.x,s.y+=o.y):s=o,t=e.frameElement,e=e.parent}return s},A.getDocSize=function(t){var e=t||window.document,i=e.body,r=e.documentElement,s=Math.max;return{width:s(s(i.scrollWidth,r.scrollWidth),s(i.offsetWidth,r.offsetWidth),s(i.clientWidth,r.clientWidth)),height:s(s(i.scrollHeight,r.scrollHeight),s(i.offsetHeight,r.offsetHeight),s(i.clientHeight,r.clientHeight))}},A.externalizeStyleCSSTextToInnerHTML=function(t){var e,s,n=!1;if(r.isDefined(i.useCSSText)||(e=document.createElement("style"),e.setAttribute("type","text/css"),i.useCSSText=r.isDefined(e.styleSheet)),i.useCSSText){e="style"==t.nodeName.toLowerCase()?[t]:t.querySelectorAll("style");for(var o=0,a=e.length;o<a;o++)s=e[o],s.styleSheet&&s.styleSheet.cssText&&s.styleSheet.cssText.replace(/\s/gi,"").length!=s.innerHTML.replace(/\s/gi,"").length&&(s.innerHTML=s.styleSheet.cssText,n=!0)}return n};var R=function(){};R.prototype={useWhiteListing:!1,dynamicWhiteListUnblocks:[],dynamicSelectorsToMask:[],dynamicSelectorsToUnmask:[],dynamicWhiteListEls:[],dynamicSelectorsToRemask:[],dynamicSelectorsToBlockAssets:[],staticWhiteListEls:[],isMasking:!1,noMaskClassArray:[]};var B="fsrHiddenBlockStart",P="fsrHiddenBlockEnd",U="fsrWhiteListStart",F="fsrWhiteListEnd";R.prototype._maskStaticBySelector=function(t,e,i){var s,n,o,a=e.document,h=a.querySelectorAll(t),c=i?U:B,l=i?F:P,d="_fsrWL";for(s=0;s<h.length;s++)n=h[s],"BODY"==n.nodeName?r.hasClass(n,d)||(r.addClass(n,d),n.insertBefore(a.createComment(c),n.firstChild),n.appendChild(a.createComment(l))):(o=n.parentNode,r.hasClass(o,d)||(r.addClass(o,d),o.insertBefore(a.createComment(c),n),o.insertBefore(a.createComment(l),n.nextSibling)))},R.prototype._remaskBySelector=function(t,e){r.removeClass(e.document.querySelectorAll(t),"fsrVisible")},R.prototype._unmaskStaticBySelector=function(t,e){r.addClass(e.document.querySelectorAll(t),"fsrVisible")},R.prototype._obscureBySelector=function(t,e){r.addClass(e.document.querySelectorAll(t),"fsrObscure")},R.prototype._maskDynamicBySelector=function(t,e,i){t.length>0&&"string"==typeof t&&(void 0===i||""===i||"inTxBlk"==i?(this._maskStaticBySelector(t,e,!1),this.dynamicSelectorsToMask[this.dynamicSelectorsToMask.length]=t):"evUnblk"==i?(this._unmaskStaticBySelector(t,e),
this.dynamicSelectorsToUnmask[this.dynamicSelectorsToUnmask.length]=t):"evReblk"==i?(this._remaskBySelector(t,e),this.dynamicSelectorsToRemask[this.dynamicSelectorsToRemask.length]=t):"DOMWL"==i&&(this._maskStaticBySelector(t,e,!0),this.dynamicWhiteListUnblocks[this.dynamicWhiteListUnblocks.length]=t))},R.prototype._unmaskDynamicBySelector=function(t,e){this._maskDynamicBySelector(t,e,"evUnblk")},R.prototype._maskAssetDynamicBySelector=function(t,e){if(r.addClass(e.document.querySelectorAll(t),"fsrHidden"),t.length>0){"string"==typeof t&&(t=[t]);for(var i=this.dynamicSelectorsToBlockAssets,s=0;s<t.length;s++)i[i.length]=t[s]}},R.prototype._removeVisibility=function(t,e){this._maskDynamicBySelector(t,e,"evReblk")},R.prototype._whiteListUnblockDynamic=function(t,e){this._maskDynamicBySelector(t,e,"DOMWL")},R.prototype.addClassToNoMaskArray=function(t){this.noMaskClassArray[this.noMaskClassArray.length]=t},R.prototype.isNodeMasked=function(t){var e,i,r,s=!0;if(this.noMaskClassArray.length>0&&t.className)for(e=this.noMaskClassArray,i=0;i<e.length;i++)r=e[i],t.className.indexOf(r)>-1&&(s=!1),i=r=null;return t.childNodes.length<1||!s||!!(t.childNodes[0].data&&t.childNodes[0].data.indexOf(B)>-1)},R.prototype._tagDynamicMaskNodes=function(t,e,i){var s,n,o,a=i.document,h=!1,c="_fsrWL";if(!this.isMasking){if(this.isMasking=!0,this.useWhiteListing){if(h=!0,this.dynamicWhiteListUnblocks.length>0&&!e)for(o=a.querySelectorAll(this.dynamicWhiteListUnblocks.join(",")),s=0,n=o.length;s<n;s++)if(A.nodeBelongsTo(t,o[s])||o[s]==t){if(!this.isNodeMasked(t)){h=!1;break}}else A.nodeBelongsTo(o[s],t)&&(this.isNodeMasked(o[s])||r.hasClass(o[s],c)||(r.addClass(o[s],c),o[s].insertBefore(a.createComment(U),o[s].firstChild),o[s].appendChild(a.createComment(F))))}else if(this.dynamicSelectorsToMask.length>0&&!e)for(o=a.querySelectorAll(this.dynamicSelectorsToMask.join(",")),s=0,n=o.length;s<n;s++)if(A.nodeBelongsTo(t,o[s])||o[s]==t){if(!this.isNodeMasked(t)){h=!0;break}}else A.nodeBelongsTo(o[s],t)&&(this.isNodeMasked(o[s])||(o[s].insertBefore(a.createComment(B),o[s].firstChild),o[s].appendChild(a.createComment(P))));if(this.dynamicSelectorsToUnmask.length>0){for(s=this.dynamicSelectorsToUnmask.length-1;s>=0;s--)r.addClass(a.querySelectorAll(this.dynamicSelectorsToUnmask[s]),"fsrVisible");for(n=this.dynamicSelectorsToRemask.length-1;n>=0;n--)r.removeClass(a.querySelectorAll(this.dynamicSelectorsToRemask[n]),"fsrVisible")}if(this.dynamicSelectorsToBlockAssets.length>0)for(s=this.dynamicSelectorsToBlockAssets.length-1;s>=0;s--)r.addClass(a.querySelectorAll(this.dynamicSelectorsToBlockAssets[s]),"fsrHidden");this.isMasking=!1}return h},R.prototype.maskDocument=function(t,e){var i=(e.location.href||"about:blank").toLowerCase();if(this.useWhiteListing=!1,t.staticWhiteListEls)for(var s in t.staticWhiteListEls)if(t.staticWhiteListEls.hasOwnProperty(s)&&(i.indexOf(s)>-1||r.testAgainstSearch(s,i))){this.useWhiteListing=!0;break}if(t.dynamicWhiteListEls)for(var n in t.dynamicWhiteListEls)if(t.dynamicWhiteListEls.hasOwnProperty(n)&&(i.indexOf(n)>-1||r.testAgainstSearch(n,i))){this.useWhiteListing=!0;break}t.useWhiteListing=this.useWhiteListing;var o=function(t,e,s,n,o){for(var a in e)(i.indexOf(a)>-1||r.testAgainstSearch(a,i))&&s.call(t,e[a],n,o)};this.useWhiteListing?(o(this,t.staticWhiteListEls,this._maskStaticBySelector,e,!0),o(this,t.dynamicWhiteListEls,this._whiteListUnblockDynamic,e)):(o(this,t.staticBlockEls,this._maskStaticBySelector,e),o(this,t.dynamicBlockEls,this._maskDynamicBySelector,e)),o(this,t.staticVisibleEls,this._unmaskStaticBySelector,e),o(this,t.dynamicVisibleEls,this._unmaskDynamicBySelector,e),o(this,t.assetBlockEls,this._maskAssetDynamicBySelector,e),o(this,t.removeVisibilityEls,this._removeVisibility,e),o(this,t.obscureEls,this._obscureBySelector,e)};var W=function(t,e,i,s,n,config,o,a,c,l,d){m._browser=g._browser=this.browser=e,d&&this.setXFrameScrollPosition(d),this.isIframeMode=!!o,this.iFramexPathPrefix=l||"",this.ifrid=a,this.iFrameParentFr=c,this.config=config,this.stg=t,this.win=i,this.ready=new r.FSEvent,this.childRecorders=[],this.disposed=!1,this.DomUpdated=new r.FSEvent,this.DomUpdated.subscribe(r.proxy(function(){this.update.apply(this,arguments)},this)),this.EmergencySendRequired=new r.FSEvent,this.instancePath=s||[],this.isMousedOverWindow=!1,this.logger=this.eventcap=this.recordParent=null,this.win.document&&(this.recordParent=n,n||(this.logger=new f(t,e,this,this.config)),this.getLogger().StorageReady.subscribe(r.proxy(function(){this.ready.fire(),config.advancedSettings&&(this.masker=new R,this.masker.maskDocument(config.advancedSettings.pii,this.win)),this.serializeDom(),this.eventcap=new g(this,e,this.config,this.isIframeMode),y.performFrameBindings(this),o||h.BeginTrackingChildFrames(this),n||this.logger._flushAndTransmit(!0),e.isMobile&&this.setTransmitOK()},this),!0,!0)),n=null,i=null,s=null};W.prototype.update=function(t){t||(t=this.doc.body),0!==t.childNodes.length&&(this.eventcap.updateNodeBinding(t,!!t),y.performFrameBindings(this,t))},W.prototype.getLogger=function(){return this.recordParent?this.recordParent.getLogger():this.logger||{log:function(){}}},W.prototype.logCustomEvent=function(t,e,i){r.isDefined(t)&&"string"==typeof t||(t=""),this.getLogger().log(this,i,{attrName:t,v:JSON.stringify(e)})},W.prototype.getPath=function(){return this._getPathCache||(this.recordParent?this._getPathCache=this.instancePath.concat(this.recordParent.getPath()):this._getPathCache=this.instancePath),this._getPathCache},W.prototype.getTop=function(){return this.recordParent?this.recordParent.getTop():this},W.prototype.setTransmitOK=function(){this.getLogger().setTransmitOK()},W.prototype.processImmediately=function(t){this.getLogger().processImmediately(t)},W.prototype.setTransmitNotOK=function(){this.getLogger().setTransmitNotOK()},W.prototype.cancelRecord=function(t){this.getLogger().cancelRecord(t)},W.prototype.dispose=function(){var t=this;if(t.win||(t=t.recorder),!this.disposed){this.disposed=!0;for(var e=0;e<t.childRecorders.length;e++)t.childRecorders[e].dispose();t.eventcap&&t.eventcap.dispose(),t.lastRawMouseCoords&&(t.lastRawMouseCoords=null),t.eventcap=null,t.win=null,t.recordParent=null,t.DomUpdated.unsubscribeAll(),t.DomUpdated=null,t.logger&&(t.logger.dispose(),t.logger=null),t=null,r.Unbind("record:*")}},W.prototype.serializeDom=function(){if(this.getLogger()){var t;if(this.win==this.win.top){var i=this.win.document.body;t=m.getCacheableObject(i.innerHTML,k.getMapping(i)).uid}this.getLogger().log(this,f.EVENT_TYPES.DOM_SERIALIZE,{dom:_(this.win,this.getPath(),this.config),url:this.win.location.href.toString(),v:this.browser.agent,buid:t,start:e.startTS,tz:(new Date).getTimezoneOffset(),domloadtime:r.now()-e.startTS})}},W.prototype.getGlobalId=function(){return this.getLogger().gsessionid},W.prototype.setXFrameScrollPosition=function(t){this.ifrFrameOffset=t};var H=function(t,e){var i={};t.ACS||{};i.beginTransmitting=function(){e.beginTransmitting()},i.cancelRecord=function(){e.cancelRecord()},i.getSession=function(){var t=e.recorder.logger;return{sessionid:t.sessionid,gsessionid:t.gsessionid,sig:t.gsessionid+"/"+t.sessionid}},t.FSR||(t.FSR={}),t.ACS||(t.ACS={}),r.ext(t.ACS,i,!1)},V=function(config,t){this.config=config,this.browser=t};V.prototype.supported=function(){var t,e=this.config.advancedSettings,i=this.browser,s=this.config.blacklist,n=e.device_type_support,o=location.toString();if(!(e.browser_cutoff[i.browser.name]&&i.browser.actualVersion>=e.browser_cutoff[i.browser.name]||e.platform_cutoff[i.os.name]&&i.os.version>=e.platform_cutoff[i.os.name]))return!1;if(n&&(!n.desktop&&!i.isMobile||!n.tablet&&i.isTablet||!n.phone&&i.isMobile&&!i.isTablet))return!1;if(s&&s.active&&s.text&&s.text.length>0)for(t=0;t<s.text.length;t++)if(r.testAgainstSearch(s.text[t],o))return!1;for(t=0;t<e.device_blacklist.length;t++)if(i.agent.toLowerCase().indexOf(e.device_blacklist[t].toLowerCase())>-1)return!1;return!0};var z=null;return s.prototype.isIframe=function(){return window!=window.top},s.prototype.isCrossDomainFrame=function(){if(this.isIframe())try{var t=window.top.document.body.toString().length;return t.length<0}catch(t){return!0}return!1},s.prototype.initialize=function(t,e,s,n){if("undefined"!=typeof Uint8Array){var o=this.isIframe(),a=this.isCrossDomainFrame();if(!o||a){if(n&&r.ext(i.advancedSettings||{},n),this.winobj=e,this.browser=t,i&&i.instances)for(var h=0;h<i.instances.length;h++){var c=i.instances[h];if(!c.disabled){r.ext(i,c);break}}this.crit=new V(i,t),this.stg=s,s.fstg.sync(r.proxy(function(){t.browserReady.subscribe(r.proxy(function(){this.crit.supported()&&(a?r.Bind(window,"message",r.proxy(function(n){if(n.data=n.data+"",n.data&&r.isFunction(n.data.indexOf)&&n.data.length>3&&n.data.indexOf("{")>-1){var o;try{o=JSON.parse(n.data)}catch(t){return}o.cxr&&o.id?(this.recorder=new W(s,t,e,o.xp,null,i,a,o.id,n.source,o.sid,o.sp),r.Bind(window,"unload",r.proxy(function(){this.recorder&&(this.recorder.dispose(),this.recorder=null)},this))):o.cxsp&&this.recorder&&this.recorder.setXFrameScrollPosition(o.sp)}},this)):(this.recorder=new W(s,t,e,null,null,i,a),r.Bind(window,"unload",r.proxy(function(){this.recorder&&(this.recorder.dispose(),this.recorder=null)},this)),o||H(e,this)))},this),!0,!0)},this))}}},s.prototype.beginTransmitting=function(){this.recorder&&this.recorder.setTransmitOK()},s.prototype.dispose=function(){this.recorder&&(this.transmitIfCan(),this.recorder.dispose(),z=null)},s.prototype.transmitIfCan=function(){var t=this.recorder;if(t){var e=t.getLogger();e&&e.transmitting&&e._flushAndTransmit()}},s.prototype.cancelRecord=function(){this.recorder&&(this.recorder.dispose(),this.recorder=null)},s.getInstance=function(t,e,i,r){return null===z&&(z=new s(t,e,i,r)),z},s});